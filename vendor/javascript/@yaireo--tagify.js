var w="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var y={};!function(w,x){y=x()}(0,(function(){function t(w,y){var x=Object.keys(w);if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(w);y&&(O=O.filter((function(y){return Object.getOwnPropertyDescriptor(w,y).enumerable}))),x.push.apply(x,O)}return x}function e(w){for(var y=1;y<arguments.length;y++){var x=null!=arguments[y]?arguments[y]:{};y%2?t(Object(x),!0).forEach((function(y){i(w,y,x[y])})):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(x)):t(Object(x)).forEach((function(y){Object.defineProperty(w,y,Object.getOwnPropertyDescriptor(x,y))}))}return w}function i(w,y,x){return(y=function(w){var y=function(w,y){if("object"!=typeof w||null===w)return w;var x=w[Symbol.toPrimitive];if(void 0!==x){var O=x.call(w,y||"default");if("object"!=typeof O)return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===y?String:Number)(w)}(w,"string");return"symbol"==typeof y?y:String(y)}(y))in w?Object.defineProperty(w,y,{value:x,enumerable:!0,configurable:!0,writable:!0}):w[y]=x,w}const s=(w,y,x,O)=>(w=""+w,y=""+y,O&&(w=w.trim(),y=y.trim()),x?w==y:w.toLowerCase()==y.toLowerCase()),a=(w,y)=>w&&Array.isArray(w)&&w.map((w=>n(w,y)));function n(w,y){var x,O={};for(x in w)y.indexOf(x)<0&&(O[x]=w[x]);return O}function o(w){var y=document.createElement("div");return w.replace(/\&#?[0-9a-z]+;/gi,(function(w){return y.innerHTML=w,y.innerText}))}function r(w){return(new DOMParser).parseFromString(w.trim(),"text/html").body.firstElementChild}function l(w,y){for(y=y||"previous";w=w[y+"Sibling"];)if(3==w.nodeType)return w}function d(w){return"string"==typeof w?w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):w}function h(w){var y=Object.prototype.toString.call(w).split(" ")[1].slice(0,-1);return w===Object(w)&&"Array"!=y&&"Function"!=y&&"RegExp"!=y&&"HTMLUnknownElement"!=y}function g(w,y,x){function s(w,y){for(var x in y)if(y.hasOwnProperty(x)){if(h(y[x])){h(w[x])?s(w[x],y[x]):w[x]=Object.assign({},y[x]);continue}if(Array.isArray(y[x])){w[x]=Object.assign([],y[x]);continue}w[x]=y[x]}}return w instanceof Object||(w={}),s(w,y),x&&s(w,x),w}function p(){const w=[],y={};for(let x of arguments)for(let O of x)h(O)?y[O.value]||(w.push(O),y[O.value]=1):w.includes(O)||w.push(O);return w}function c(w){return String.prototype.normalize?"string"==typeof w?w.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:w}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent);function m(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(w=>(w^crypto.getRandomValues(new Uint8Array(1))[0]&15>>w/4).toString(16)))}function v(y){return y&&y.classList&&y.classList.contains((this||w).settings.classNames.tag)}function f(w,y){var x=window.getSelection();return y=y||x.getRangeAt(0),"string"==typeof w&&(w=document.createTextNode(w)),y&&(y.deleteContents(),y.insertNode(w)),w}function T(w,y,x){return w?(y&&(w.__tagifyTagData=x?y:g({},w.__tagifyTagData||{},y)),w.__tagifyTagData):(console.warn("tag element doesn't exist",w,y),y)}var y={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,onChangeAfterBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,userInput:!0,keepInvalidTags:!1,createInvalidTags:!0,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:" "},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",scopeLoading:"tagify--loading",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty",inputInvalid:"tagify__input--invalid",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownHeader:"tagify__dropdown__header",dropdownFooter:"tagify__dropdown__footer",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownItemHidden:"tagify__dropdown__item--hidden",dropdownInital:"tagify__dropdown--initial",tag:"tagify__tag",tagText:"tagify__tag-text",tagX:"tagify__tag__removeBtn",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,includeSelectedTags:!1,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function b(){(this||w).dropdown={};for(let y in(this||w)._dropdown)(this||w).dropdown[y]="function"==typeof(this||w)._dropdown[y]?(this||w)._dropdown[y].bind(this||w):(this||w)._dropdown[y];(this||w).dropdown.refs()}var x={refs(){(this||w).DOM.dropdown=this.parseTemplate("dropdown",[(this||w).settings]),(this||w).DOM.dropdown.content=(this||w).DOM.dropdown.querySelector("[data-selector='tagify-suggestions-wrapper']")},getHeaderRef(){return(this||w).DOM.dropdown.querySelector("[data-selector='tagify-suggestions-header']")},getFooterRef(){return(this||w).DOM.dropdown.querySelector("[data-selector='tagify-suggestions-footer']")},getAllSuggestionsRefs(){return[...(this||w).DOM.dropdown.content.querySelectorAll((this||w).settings.classNames.dropdownItemSelector)]},show(y){var x,O,D,M=(this||w).settings,I="mix"==M.mode&&!M.enforceWhitelist,E=!M.whitelist||!M.whitelist.length,S="manual"==M.dropdown.position;if(y=void 0===y?(this||w).state.inputText:y,!(E&&!I&&!M.templates.dropdownItemNoMatch||!1===M.dropdown.enable||(this||w).state.isLoading||(this||w).settings.readonly)){if(clearTimeout((this||w).dropdownHide__bindEventsTimeout),(this||w).suggestedListItems=(this||w).dropdown.filterListItems(y),y&&!(this||w).suggestedListItems.length&&(this.trigger("dropdown:noMatch",y),M.templates.dropdownItemNoMatch&&(D=M.templates.dropdownItemNoMatch.call(this||w,{value:y}))),!D){if((this||w).suggestedListItems.length)y&&I&&!(this||w).state.editing.scope&&!s((this||w).suggestedListItems[0].value,y)&&(this||w).suggestedListItems.unshift({value:y});else{if(!y||!I||(this||w).state.editing.scope)return(this||w).input.autocomplete.suggest.call(this||w),void(this||w).dropdown.hide();(this||w).suggestedListItems=[{value:y}]}O=""+(h(x=(this||w).suggestedListItems[0])?x.value:x),M.autoComplete&&O&&0==O.indexOf(y)&&(this||w).input.autocomplete.suggest.call(this||w,x)}(this||w).dropdown.fill(D),M.dropdown.highlightFirst&&(this||w).dropdown.highlightOption((this||w).DOM.dropdown.content.querySelector(M.classNames.dropdownItemSelector)),(this||w).state.dropdown.visible||setTimeout((this||w).dropdown.events.binding.bind(this||w)),(this||w).state.dropdown.visible=y||!0,(this||w).state.dropdown.query=y,this.setStateSelection(),S||setTimeout((()=>{(this||w).dropdown.position(),(this||w).dropdown.render()})),setTimeout((()=>{this.trigger("dropdown:show",(this||w).DOM.dropdown)}))}},hide(y){var x=(this||w).DOM,O=x.scope,D=x.dropdown,M="manual"==(this||w).settings.dropdown.position&&!y;if(D&&document.body.contains(D)&&!M)return window.removeEventListener("resize",(this||w).dropdown.position),(this||w).dropdown.events.binding.call(this||w,!1),O.setAttribute("aria-expanded",!1),D.parentNode.removeChild(D),setTimeout((()=>{(this||w).state.dropdown.visible=!1}),100),(this||w).state.dropdown.query=(this||w).state.ddItemData=(this||w).state.ddItemElm=(this||w).state.selection=null,(this||w).state.tag&&(this||w).state.tag.value.length&&((this||w).state.flaggedTags[(this||w).state.tag.baseOffset]=(this||w).state.tag),this.trigger("dropdown:hide",D),this||w},toggle(y){(this||w).dropdown[(this||w).state.dropdown.visible&&!y?"hide":"show"]()},render(){var y,x,O,D=(y=(this||w).DOM.dropdown,(O=y.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(O),x=O.clientHeight,O.parentNode.removeChild(O),x),M=(this||w).settings;return"number"==typeof M.dropdown.enabled&&M.dropdown.enabled>=0?((this||w).DOM.scope.setAttribute("aria-expanded",!0),document.body.contains((this||w).DOM.dropdown)||((this||w).DOM.dropdown.classList.add(M.classNames.dropdownInital),(this||w).dropdown.position(D),M.dropdown.appendTarget.appendChild((this||w).DOM.dropdown),setTimeout((()=>(this||w).DOM.dropdown.classList.remove(M.classNames.dropdownInital)))),this||w):this||w},fill(y){y="string"==typeof y?y:(this||w).dropdown.createListHTML(y||(this||w).suggestedListItems);var x,O=(this||w).settings.templates.dropdownContent.call(this||w,y);(this||w).DOM.dropdown.content.innerHTML=(x=O)?x.replace(/\>[\r\n ]+\</g,"><").replace(/(<.*?>)|\s+/g,((w,y)=>y||" ")):""},fillHeaderFooter(){var y=(this||w).dropdown.filterListItems((this||w).state.dropdown.query),x=this.parseTemplate("dropdownHeader",[y]),O=this.parseTemplate("dropdownFooter",[y]),D=(this||w).dropdown.getHeaderRef(),M=(this||w).dropdown.getFooterRef();x&&D?.parentNode.replaceChild(x,D),O&&M?.parentNode.replaceChild(O,M)},refilter(y){y=y||(this||w).state.dropdown.query||"",(this||w).suggestedListItems=(this||w).dropdown.filterListItems(y),(this||w).dropdown.fill(),(this||w).suggestedListItems.length||(this||w).dropdown.hide(),this.trigger("dropdown:updated",(this||w).DOM.dropdown)},position(y){var x=(this||w).settings.dropdown;if("manual"!=x.position){var O,D,M,I,E,S,_=(this||w).DOM.dropdown,C=x.placeAbove,A=x.appendTarget===document.body,L=A?window.pageYOffset:x.appendTarget.scrollTop,k=document.fullscreenElement||document.webkitFullscreenElement||document.documentElement,V=k.clientHeight,P=Math.max(k.clientWidth||0,window.innerWidth||0)>480?x.position:"all",R=(this||w).DOM["input"==P?"input":"scope"];if(y=y||_.clientHeight,(this||w).state.dropdown.visible){if("text"==P?(M=(O=function(){const w=document.getSelection();if(w.rangeCount){const y=w.getRangeAt(0),x=y.startContainer,O=y.startOffset;let D,M;if(O>0)return M=document.createRange(),M.setStart(x,O-1),M.setEnd(x,O),D=M.getBoundingClientRect(),{left:D.right,top:D.top,bottom:D.bottom};if(x.getBoundingClientRect)return x.getBoundingClientRect()}return{left:-9999,top:-9999}}()).bottom,D=O.top,I=O.left,E="auto"):(S=function(w){for(var y=0,x=0;w&&w!=k;)y+=w.offsetLeft||0,x+=w.offsetTop||0,w=w.parentNode;return{left:y,top:x}}(x.appendTarget),D=(O=R.getBoundingClientRect()).top-S.top,M=O.bottom-1-S.top,I=O.left-S.left,E=O.width+"px"),!A){let w=function(){for(var w=0,y=x.appendTarget.parentNode;y;)w+=y.scrollTop||0,y=y.parentNode;return w}();D+=w,M+=w}D=Math.floor(D),M=Math.ceil(M),C=void 0===C?V-O.bottom<y:C,_.style.cssText="left:"+(I+window.pageXOffset)+"px; width:"+E+";"+(C?"top: "+(D+L)+"px":"top: "+(M+L)+"px"),_.setAttribute("placement",C?"top":"bottom"),_.setAttribute("position",P)}}},events:{binding(){let y=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var x=(this||w).dropdown.events.callbacks,O=(this||w).listeners.dropdown=(this||w).listeners.dropdown||{position:(this||w).dropdown.position.bind(this||w,null),onKeyDown:x.onKeyDown.bind(this||w),onMouseOver:x.onMouseOver.bind(this||w),onMouseLeave:x.onMouseLeave.bind(this||w),onClick:x.onClick.bind(this||w),onScroll:x.onScroll.bind(this||w)},D=y?"addEventListener":"removeEventListener";"manual"!=(this||w).settings.dropdown.position&&(document[D]("scroll",O.position,!0),window[D]("resize",O.position),window[D]("keydown",O.onKeyDown)),(this||w).DOM.dropdown[D]("mouseover",O.onMouseOver),(this||w).DOM.dropdown[D]("mouseleave",O.onMouseLeave),(this||w).DOM.dropdown[D]("mousedown",O.onClick),(this||w).DOM.dropdown.content[D]("scroll",O.onScroll)},callbacks:{onKeyDown(y){if((this||w).state.hasFocus&&!(this||w).state.composing){var x=(this||w).DOM.dropdown.querySelector((this||w).settings.classNames.dropdownItemActiveSelector),O=(this||w).dropdown.getSuggestionDataByNode(x);switch(y.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":y.preventDefault();var D=(this||w).dropdown.getAllSuggestionsRefs(),M="ArrowUp"==y.key||"Up"==y.key;x&&(x=(this||w).dropdown.getNextOrPrevOption(x,!M)),x&&x.matches((this||w).settings.classNames.dropdownItemSelector)||(x=D[M?D.length-1:0]),(this||w).dropdown.highlightOption(x,!0);break;case"Escape":case"Esc":(this||w).dropdown.hide();break;case"ArrowRight":if((this||w).state.actions.ArrowLeft)return;case"Tab":if("mix"!=(this||w).settings.mode&&x&&!(this||w).settings.autoComplete.rightKey&&!(this||w).state.editing){y.preventDefault();var I=(this||w).dropdown.getMappedValue(O);return(this||w).input.autocomplete.set.call(this||w,I),!1}return!0;case"Enter":y.preventDefault(),(this||w).settings.hooks.suggestionClick(y,{tagify:this||w,tagData:O,suggestionElm:x}).then((()=>{if(x)return(this||w).dropdown.selectOption(x),x=(this||w).dropdown.getNextOrPrevOption(x,!M),void(this||w).dropdown.highlightOption(x);(this||w).dropdown.hide(),"mix"!=(this||w).settings.mode&&this.addTags((this||w).state.inputText.trim(),!0)})).catch((w=>w));break;case"Backspace":{if("mix"==(this||w).settings.mode||(this||w).state.editing.scope)return;const y=(this||w).input.raw.call(this||w);""!=y&&8203!=y.charCodeAt(0)||(!0===(this||w).settings.backspace?this.removeTags():"edit"==(this||w).settings.backspace&&setTimeout((this||w).editTag.bind(this||w),0))}}}},onMouseOver(y){var x=y.target.closest((this||w).settings.classNames.dropdownItemSelector);x&&(this||w).dropdown.highlightOption(x)},onMouseLeave(y){(this||w).dropdown.highlightOption()},onClick(y){if(0==y.button&&y.target!=(this||w).DOM.dropdown&&y.target!=(this||w).DOM.dropdown.content){var x=y.target.closest((this||w).settings.classNames.dropdownItemSelector),O=(this||w).dropdown.getSuggestionDataByNode(x);(this||w).state.actions.selectOption=!0,setTimeout((()=>(this||w).state.actions.selectOption=!1),50),(this||w).settings.hooks.suggestionClick(y,{tagify:this||w,tagData:O,suggestionElm:x}).then((()=>{x?(this||w).dropdown.selectOption(x,y):(this||w).dropdown.hide()})).catch((w=>console.warn(w)))}},onScroll(w){var y=w.target,x=y.scrollTop/(y.scrollHeight-y.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(x)})}}},getSuggestionDataByNode(y){var x=y&&y.getAttribute("value");return(this||w).suggestedListItems.find((w=>w.value==x))||null},getNextOrPrevOption(y){let x=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var O=(this||w).dropdown.getAllSuggestionsRefs(),D=O.findIndex((w=>w===y));return x?O[D+1]:O[D-1]},highlightOption(y,x){var O,D=(this||w).settings.classNames.dropdownItemActive;if((this||w).state.ddItemElm&&((this||w).state.ddItemElm.classList.remove(D),(this||w).state.ddItemElm.removeAttribute("aria-selected")),!y)return(this||w).state.ddItemData=null,(this||w).state.ddItemElm=null,void(this||w).input.autocomplete.suggest.call(this||w);O=(this||w).dropdown.getSuggestionDataByNode(y),(this||w).state.ddItemData=O,(this||w).state.ddItemElm=y,y.classList.add(D),y.setAttribute("aria-selected",!0),x&&(y.parentNode.scrollTop=y.clientHeight+y.offsetTop-y.parentNode.clientHeight),(this||w).settings.autoComplete&&((this||w).input.autocomplete.suggest.call(this||w,O),(this||w).dropdown.position())},selectOption(y,x){var O=(this||w).settings.dropdown,D=O.clearOnSelect,M=O.closeOnSelect;if(!y)return this.addTags((this||w).state.inputText,!0),void(M&&(this||w).dropdown.hide());x=x||{};var I=y.getAttribute("value"),E="noMatch"==I,S=(this||w).suggestedListItems.find((w=>(w.value||w)==I));this.trigger("dropdown:select",{data:S,elm:y,event:x}),I&&(S||E)?((this||w).state.editing?this.onEditTagDone(null,g({__isValid:!0},this.normalizeTags([S])[0])):this["mix"==(this||w).settings.mode?"addMixTags":"addTags"]([S||(this||w).input.raw.call(this||w)],D),(this||w).DOM.input.parentNode&&(setTimeout((()=>{(this||w).DOM.input.focus(),this.toggleFocusClass(!0)})),M&&setTimeout((this||w).dropdown.hide.bind(this||w)),y.addEventListener("transitionend",(()=>{(this||w).dropdown.fillHeaderFooter(),setTimeout((()=>y.remove()),100)}),{once:!0}),y.classList.add((this||w).settings.classNames.dropdownItemHidden))):M&&setTimeout((this||w).dropdown.hide.bind(this||w))},selectAll(y){(this||w).suggestedListItems.length=0,(this||w).dropdown.hide(),(this||w).dropdown.filterListItems("");var x=(this||w).dropdown.filterListItems("");return y||(x=(this||w).state.dropdown.suggestions),this.addTags(x,!0),this||w},filterListItems(y,x){var O,D,M,I,E,S=(this||w).settings,_=S.dropdown,C=(x=x||{},[]),A=[],L=S.whitelist,k=_.maxItems>=0?_.maxItems:1/0,V=_.searchKeys,P=0;if(!(y="select"==S.mode&&(this||w).value.length&&(this||w).value[0][S.tagTextProp]==y?"":y)||!V.length)return C=_.includeSelectedTags?L:L.filter((w=>!this.isTagDuplicate(h(w)?w.value:w))),(this||w).state.dropdown.suggestions=C,C.slice(0,k);function f(w,y){return y.toLowerCase().split(" ").every((y=>w.includes(y.toLowerCase())))}for(E=_.caseSensitive?""+y:(""+y).toLowerCase();P<L.length;P++){let w,y;O=L[P]instanceof Object?L[P]:{value:L[P]};let S=Object.keys(O).some((w=>V.includes(w)))?V:["value"];_.fuzzySearch&&!x.exact?(M=S.reduce(((w,y)=>w+" "+(O[y]||"")),"").toLowerCase().trim(),_.accentedSearch&&(M=c(M),E=c(E)),w=0==M.indexOf(E),y=M===E,D=f(M,E)):(w=!0,D=S.some((w=>{var D=""+(O[w]||"");return _.accentedSearch&&(D=c(D),E=c(E)),_.caseSensitive||(D=D.toLowerCase()),y=D===E,x.exact?D===E:0==D.indexOf(E)}))),I=!_.includeSelectedTags&&this.isTagDuplicate(h(O)?O.value:O),D&&!I&&(y&&w?A.push(O):"startsWith"==_.sortby&&w?C.unshift(O):C.push(O))}return(this||w).state.dropdown.suggestions=A.concat(C),"function"==typeof _.sortby?_.sortby(A.concat(C),E):A.concat(C).slice(0,k)},getMappedValue(y){var x=(this||w).settings.dropdown.mapValueTo;return x?"function"==typeof x?x(y):y[x]||y.value:y.value},createListHTML(y){return g([],y).map(((y,x)=>{"string"!=typeof y&&"number"!=typeof y||(y={value:y});var O=(this||w).dropdown.getMappedValue(y);return O="string"==typeof O?d(O):O,(this||w).settings.templates.dropdownItem.apply(this||w,[e(e({},y),{},{mappedValue:O}),this||w])})).join("")}};const O="@yaireo/tagify/";var D,M={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},I={wrapper:(w,y)=>`<tags class="${y.classNames.namespace} ${y.mode?`${y.classNames[y.mode+"Mode"]}`:""} ${w.className}"\n                    ${y.readonly?"readonly":""}\n                    ${y.disabled?"disabled":""}\n                    ${y.required?"required":""}\n                    ${"select"===y.mode?"spellcheck='false'":""}\n                    tabIndex="-1">\n            <span ${!y.readonly&&y.userInput?"contenteditable":""} tabIndex="0" data-placeholder="${y.placeholder||"&#8203;"}" aria-placeholder="${y.placeholder||""}"\n                class="${y.classNames.input}"\n                role="textbox"\n                aria-autocomplete="both"\n                aria-multiline="${"mix"==y.mode}"></span>\n                &#8203;\n        </tags>`,tag(w,y){let x=y.settings;return`<tag title="${w.title||w.value}"\n                    contenteditable='false'\n                    spellcheck='false'\n                    tabIndex="${x.a11y.focusableTags?0:-1}"\n                    class="${x.classNames.tag} ${w.class||""}"\n                    ${this.getAttributes(w)}>\n            <x title='' class="${x.classNames.tagX}" role='button' aria-label='remove tag'></x>\n            <div>\n                <span class="${x.classNames.tagText}">${w[x.tagTextProp]||w.value}</span>\n            </div>\n        </tag>`},dropdown(w){var y=w.dropdown,x="manual"==y.position,O=`${w.classNames.dropdown}`;return`<div class="${x?"":O} ${y.classname}" role="listbox" aria-labelledby="dropdown">\n                    <div data-selector='tagify-suggestions-wrapper' class="${w.classNames.dropdownWrapper}"></div>\n                </div>`},dropdownContent(y){var x=(this||w).settings,O=(this||w).state.dropdown.suggestions;return`\n            ${x.templates.dropdownHeader.call(this||w,O)}\n            ${y}\n            ${x.templates.dropdownFooter.call(this||w,O)}\n        `},dropdownItem(y){return`<div ${this.getAttributes(y)}\n                    class='${(this||w).settings.classNames.dropdownItem} ${y.class?y.class:""}'\n                    tabindex="0"\n                    role="option">${y.mappedValue||y.value}</div>`},dropdownHeader(y){return`<header data-selector='tagify-suggestions-header' class="${(this||w).settings.classNames.dropdownHeader}"></header>`},dropdownFooter(y){var x=y.length-(this||w).settings.dropdown.maxItems;return x>0?`<footer data-selector='tagify-suggestions-footer' class="${(this||w).settings.classNames.dropdownFooter}">\n                ${x} more items. Refine your search.\n            </footer>`:""},dropdownItemNoMatch:null};var E={customBinding(){(this||w).customEventsList.forEach((y=>{this.on(y,(this||w).settings.callbacks[y])}))},binding(){let y=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var x,O=(this||w).events.callbacks,D=y?"addEventListener":"removeEventListener";if(!(this||w).state.mainEvents||!y){for(var M in(this||w).state.mainEvents=y,y&&!(this||w).listeners.main&&((this||w).events.bindGlobal.call(this||w),(this||w).settings.isJQueryPlugin&&jQuery((this||w).DOM.originalInput).on("tagify.removeAllTags",(this||w).removeAllTags.bind(this||w))),x=(this||w).listeners.main=(this||w).listeners.main||{focus:["input",O.onFocusBlur.bind(this||w)],keydown:["input",O.onKeydown.bind(this||w)],click:["scope",O.onClickScope.bind(this||w)],dblclick:["scope",O.onDoubleClickScope.bind(this||w)],paste:["input",O.onPaste.bind(this||w)],drop:["input",O.onDrop.bind(this||w)],compositionstart:["input",O.onCompositionStart.bind(this||w)],compositionend:["input",O.onCompositionEnd.bind(this||w)]})(this||w).DOM[x[M][0]][D](M,x[M][1]);clearInterval((this||w).listeners.main.originalInputValueObserverInterval),(this||w).listeners.main.originalInputValueObserverInterval=setInterval(O.observeOriginalInputValue.bind(this||w),500);var I=(this||w).listeners.main.inputMutationObserver||new MutationObserver(O.onInputDOMChange.bind(this||w));I.disconnect(),"mix"==(this||w).settings.mode&&I.observe((this||w).DOM.input,{childList:!0})}},bindGlobal(y){var x,O=(this||w).events.callbacks,D=y?"removeEventListener":"addEventListener";if((this||w).listeners&&(y||!(this||w).listeners.global))for(x of((this||w).listeners.global=(this||w).listeners.global||[{type:(this||w).isIE?"keydown":"input",target:(this||w).DOM.input,cb:O[(this||w).isIE?"onInputIE":"onInput"].bind(this||w)},{type:"keydown",target:window,cb:O.onWindowKeyDown.bind(this||w)},{type:"blur",target:(this||w).DOM.input,cb:O.onFocusBlur.bind(this||w)},{type:"click",target:document,cb:O.onClickAnywhere.bind(this||w)}],(this||w).listeners.global))x.target[D](x.type,x.cb)},unbindGlobal(){(this||w).events.bindGlobal.call(this||w,!0)},callbacks:{onFocusBlur(y){var x=(this||w).settings,O=y.target?this.trim(y.target.textContent):"",D=(this||w).value?.[0]?.[x.tagTextProp],M=y.type,I=x.dropdown.enabled>=0,E={relatedTarget:y.relatedTarget},S=(this||w).state.actions.selectOption&&(I||!x.dropdown.closeOnSelect),_=(this||w).state.actions.addNew&&I,C=y.relatedTarget&&v.call(this||w,y.relatedTarget)&&(this||w).DOM.scope.contains(y.relatedTarget);if("blur"==M){if(y.relatedTarget===(this||w).DOM.scope)return(this||w).dropdown.hide(),void(this||w).DOM.input.focus();this.postUpdate(),x.onChangeAfterBlur&&this.triggerChangeEvent()}if(!S&&!_)if((this||w).state.hasFocus="focus"==M&&+new Date,this.toggleFocusClass((this||w).state.hasFocus),"mix"!=x.mode){if("focus"==M)return this.trigger("focus",E),void(0!==x.dropdown.enabled&&x.userInput||(this||w).dropdown.show((this||w).value.length?"":void 0));"blur"==M&&(this.trigger("blur",E),this.loading(!1),"select"==x.mode&&(C&&(this.removeTags(),O=""),D===O&&(O="")),O&&!(this||w).state.actions.selectOption&&x.addTagOnBlur&&this.addTags(O,!0)),(this||w).DOM.input.removeAttribute("style"),(this||w).dropdown.hide()}else"focus"==M?this.trigger("focus",E):"blur"==y.type&&(this.trigger("blur",E),this.loading(!1),(this||w).dropdown.hide(),(this||w).state.dropdown.visible=void 0,this.setStateSelection())},onCompositionStart(y){(this||w).state.composing=!0},onCompositionEnd(y){(this||w).state.composing=!1},onWindowKeyDown(y){var x,O=document.activeElement;if(v.call(this||w,O)&&(this||w).DOM.scope.contains(document.activeElement))switch(x=O.nextElementSibling,y.key){case"Backspace":(this||w).settings.readonly||(this.removeTags(O),(x||(this||w).DOM.input).focus());break;case"Enter":setTimeout((this||w).editTag.bind(this||w),0,O)}},onKeydown(y){var x=(this||w).settings;if(!(this||w).state.composing&&x.userInput){"select"==x.mode&&x.enforceWhitelist&&(this||w).value.length&&"Tab"!=y.key&&y.preventDefault();var O=this.trim(y.target.textContent);if(this.trigger("keydown",{event:y}),"mix"==x.mode){switch(y.key){case"Left":case"ArrowLeft":(this||w).state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if((this||w).state.editing)return;var M=document.getSelection(),I="Delete"==y.key&&M.anchorOffset==(M.anchorNode.length||0),E=M.anchorNode.previousSibling,S=1==M.anchorNode.nodeType||!M.anchorOffset&&E&&1==E.nodeType&&M.anchorNode.previousSibling;o((this||w).DOM.input.innerHTML);var _,C,A,L=this.getTagElms();if("edit"==x.backspace&&S)return _=1==M.anchorNode.nodeType?null:M.anchorNode.previousElementSibling,setTimeout((this||w).editTag.bind(this||w),0,_),void y.preventDefault();if(u()&&S instanceof Element)return A=l(S),S.hasAttribute("readonly")||S.remove(),(this||w).DOM.input.focus(),void setTimeout((()=>{this.placeCaretAfterNode(A),(this||w).DOM.input.click()}));if("BR"==M.anchorNode.nodeName)return;if((I||S)&&1==M.anchorNode.nodeType?C=0==M.anchorOffset?I?L[0]:null:L[Math.min(L.length,M.anchorOffset)-1]:I?C=M.anchorNode.nextElementSibling:S instanceof Element&&(C=S),3==M.anchorNode.nodeType&&!M.anchorNode.nodeValue&&M.anchorNode.previousElementSibling&&y.preventDefault(),(S||I)&&!x.backspace)return void y.preventDefault();if("Range"!=M.type&&!M.anchorOffset&&M.anchorNode==(this||w).DOM.input&&"Delete"!=y.key)return void y.preventDefault();if("Range"!=M.type&&C&&C.hasAttribute("readonly"))return void this.placeCaretAfterNode(l(C));clearTimeout(D),D=setTimeout((()=>{var y=document.getSelection();o((this||w).DOM.input.innerHTML),!I&&y.anchorNode.previousSibling,(this||w).value=[].map.call(L,((w,y)=>{var x=T(w);if(w.parentNode||x.readonly)return x;this.trigger("remove",{tag:w,index:y,data:x})})).filter((w=>w))}),20)}return!0}switch(y.key){case"Backspace":"select"==x.mode&&x.enforceWhitelist&&(this||w).value.length?this.removeTags():(this||w).state.dropdown.visible&&"manual"!=x.dropdown.position||""!=y.target.textContent&&8203!=O.charCodeAt(0)||(!0===x.backspace?this.removeTags():"edit"==x.backspace&&setTimeout((this||w).editTag.bind(this||w),0));break;case"Esc":case"Escape":if((this||w).state.dropdown.visible)return;y.target.blur();break;case"Down":case"ArrowDown":(this||w).state.dropdown.visible||(this||w).dropdown.show();break;case"ArrowRight":{let y=(this||w).state.inputSuggestion||(this||w).state.ddItemData;if(y&&x.autoComplete.rightKey)return void this.addTags([y],!0);break}case"Tab":{let w="select"==x.mode;if(!O||w)return!0;y.preventDefault()}case"Enter":if((this||w).state.dropdown.visible&&"manual"!=x.dropdown.position)return;y.preventDefault(),setTimeout((()=>{(this||w).state.dropdown.visible||(this||w).state.actions.selectOption||this.addTags(O,!0)}))}}},onInput(y){this.postUpdate();var x=(this||w).settings;if("mix"==x.mode)return(this||w).events.callbacks.onMixTagsInput.call(this||w,y);var O=(this||w).input.normalize.call(this||w),D=O.length>=x.dropdown.enabled,M={value:O,inputElm:(this||w).DOM.input},I=this.validateTag({value:O});"select"==x.mode&&this.toggleScopeValidation(I),M.isValid=I,(this||w).state.inputText!=O&&((this||w).input.set.call(this||w,O,!1),-1!=O.search(x.delimiters)?this.addTags(O)&&(this||w).input.set.call(this||w):x.dropdown.enabled>=0&&(this||w).dropdown[D?"show":"hide"](O),this.trigger("input",M))},onMixTagsInput(y){var x,O,D,M,I,E,S,_,C=(this||w).settings,A=(this||w).value.length,L=this.getTagElms(),k=document.createDocumentFragment(),V=window.getSelection().getRangeAt(0),P=[].map.call(L,(w=>T(w).value));if("deleteContentBackward"==y.inputType&&u()&&(this||w).events.callbacks.onKeydown.call(this||w,{target:y.target,key:"Backspace"}),(this||w).value.slice().forEach((w=>{w.readonly&&!P.includes(w.value)&&k.appendChild(this.createTagElem(w))})),k.childNodes.length&&(V.insertNode(k),this.setRangeAtStartEnd(!1,k.lastChild)),L.length!=A)return(this||w).value=[].map.call(this.getTagElms(),(w=>T(w))),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(E=window.getSelection()).rangeCount>0&&3==E.anchorNode.nodeType){if((V=E.getRangeAt(0).cloneRange()).collapse(!0),V.setStart(E.focusNode,0),D=(x=V.toString().slice(0,V.endOffset)).split(C.pattern).length-1,(O=x.match(C.pattern))&&(M=x.slice(x.lastIndexOf(O[O.length-1]))),M){if((this||w).state.actions.ArrowLeft=!1,(this||w).state.tag={prefix:M.match(C.pattern)[0],value:M.replace(C.pattern,"")},(this||w).state.tag.baseOffset=E.baseOffset-(this||w).state.tag.value.length,_=(this||w).state.tag.value.match(C.delimiters))return(this||w).state.tag.value=(this||w).state.tag.value.replace(C.delimiters,""),(this||w).state.tag.delimiters=_[0],this.addTags((this||w).state.tag.value,C.dropdown.clearOnSelect),void(this||w).dropdown.hide();I=(this||w).state.tag.value.length>=C.dropdown.enabled;try{S=(S=(this||w).state.flaggedTags[(this||w).state.tag.baseOffset]).prefix==(this||w).state.tag.prefix&&S.value[0]==(this||w).state.tag.value[0],(this||w).state.flaggedTags[(this||w).state.tag.baseOffset]&&!(this||w).state.tag.value&&delete(this||w).state.flaggedTags[(this||w).state.tag.baseOffset]}catch(y){}(S||D<(this||w).state.mixMode.matchedPatternCount)&&(I=!1)}else(this||w).state.flaggedTags={};(this||w).state.mixMode.matchedPatternCount=D}setTimeout((()=>{this.update({withoutChangeEvent:!0}),this.trigger("input",g({},(this||w).state.tag,{textContent:(this||w).DOM.input.textContent})),(this||w).state.tag&&(this||w).dropdown[I?"show":"hide"]((this||w).state.tag.value)}),10)},onInputIE(y){var x=this||w;setTimeout((function(){x.events.callbacks.onInput.call(x,y)}))},observeOriginalInputValue(){(this||w).DOM.originalInput.parentNode||this.destroy(),(this||w).DOM.originalInput.value!=(this||w).DOM.originalInput.tagifyValue&&this.loadOriginalValues()},onClickAnywhere(y){y.target==(this||w).DOM.scope||(this||w).DOM.scope.contains(y.target)||(this.toggleFocusClass(!1),(this||w).state.hasFocus=!1)},onClickScope(y){var x=(this||w).settings,O=y.target.closest("."+x.classNames.tag),D=+new Date-(this||w).state.hasFocus;if(y.target!=(this||w).DOM.scope){if(!y.target.classList.contains(x.classNames.tagX))return O?(this.trigger("click",{tag:O,index:this.getNodeIndex(O),data:T(O),event:y}),void(1!==x.editTags&&1!==x.editTags.clicks||(this||w).events.callbacks.onDoubleClickScope.call(this||w,y))):void(y.target==(this||w).DOM.input&&("mix"==x.mode&&this.fixFirefoxLastTagNoCaret(),D>500)?(this||w).state.dropdown.visible?(this||w).dropdown.hide():0===x.dropdown.enabled&&"mix"!=x.mode&&(this||w).dropdown.show((this||w).value.length?"":void 0):"select"!=x.mode||0!==x.dropdown.enabled||(this||w).state.dropdown.visible||(this||w).dropdown.show());this.removeTags(y.target.parentNode)}else(this||w).state.hasFocus||(this||w).DOM.input.focus()},onPaste(y){y.preventDefault();var x,O,D=(this||w).settings;if("select"==D.mode&&D.enforceWhitelist||!D.userInput)return!1;D.readonly||(x=y.clipboardData||window.clipboardData,O=x.getData("Text"),D.hooks.beforePaste(y,{tagify:this||w,pastedText:O,clipboardData:x}).then((x=>{void 0===x&&(x=O),x&&(this.injectAtCaret(x,window.getSelection().getRangeAt(0)),"mix"==(this||w).settings.mode?(this||w).events.callbacks.onMixTagsInput.call(this||w,y):(this||w).settings.pasteAsTags?this.addTags((this||w).state.inputText+x,!0):(this||w).state.inputText=x)})).catch((w=>w)))},onDrop(w){w.preventDefault()},onEditTagInput(y,x){var O=y.closest("."+(this||w).settings.classNames.tag),D=this.getNodeIndex(O),M=T(O),I=(this||w).input.normalize.call(this||w,y),E={[(this||w).settings.tagTextProp]:I,__tagId:M.__tagId},S=this.validateTag(E);this.editTagChangeDetected(g(M,E))||!0!==y.originalIsValid||(S=!0),O.classList.toggle((this||w).settings.classNames.tagInvalid,!0!==S),M.__isValid=S,O.title=!0===S?M.title||M.value:S,I.length>=(this||w).settings.dropdown.enabled&&((this||w).state.editing&&((this||w).state.editing.value=I),(this||w).dropdown.show(I)),this.trigger("edit:input",{tag:O,index:D,data:g({},(this||w).value[D],{newValue:I}),event:x})},onEditTagPaste(w,y){var x=(y.clipboardData||window.clipboardData).getData("Text");y.preventDefault();var O=f(x);this.setRangeAtStartEnd(!1,O)},onEditTagFocus(y){(this||w).state.editing={scope:y,input:y.querySelector("[contenteditable]")}},onEditTagBlur(y){if((this||w).state.hasFocus||this.toggleFocusClass(),(this||w).DOM.scope.contains(y)){var x,O,D=(this||w).settings,M=y.closest("."+D.classNames.tag),I=T(M),E=(this||w).input.normalize.call(this||w,y),S={[D.tagTextProp]:E,__tagId:I.__tagId},_=I.__originalData,C=this.editTagChangeDetected(g(I,S)),A=this.validateTag(S);if(E)if(C){if(x=this.hasMaxTags(),O=g({},_,{[D.tagTextProp]:this.trim(E),__isValid:A}),D.transformTag.call(this||w,O,_),!0!==(A=(!x||!0===_.__isValid)&&this.validateTag(O))){if(this.trigger("invalid",{data:O,tag:M,message:A}),D.editTags.keepInvalid)return;D.keepInvalidTags?O.__isValid=A:O=_}else D.keepInvalidTags&&(delete O.title,delete O["aria-invalid"],delete O.class);this.onEditTagDone(M,O)}else this.onEditTagDone(M,_);else this.onEditTagDone(M)}},onEditTagkeydown(y,x){if(!(this||w).state.composing)switch(this.trigger("edit:keydown",{event:y}),y.key){case"Esc":case"Escape":x.parentNode.replaceChild(x.__tagifyTagData.__originalHTML,x),(this||w).state.editing=!1;case"Enter":case"Tab":y.preventDefault(),y.target.blur()}},onDoubleClickScope(y){var x,O,D=y.target.closest("."+(this||w).settings.classNames.tag),M=T(D),I=(this||w).settings;D&&I.userInput&&!1!==M.editable&&(x=D.classList.contains((this||w).settings.classNames.tagEditing),O=D.hasAttribute("readonly"),"select"==I.mode||I.readonly||x||O||!(this||w).settings.editTags||this.editTag(D),this.toggleFocusClass(!0),this.trigger("dblclick",{tag:D,index:this.getNodeIndex(D),data:T(D)}))},onInputDOMChange(y){y.forEach((y=>{y.addedNodes.forEach((y=>{if("<div><br></div>"==y.outerHTML)y.replaceWith(document.createElement("br"));else if(1==y.nodeType&&y.querySelector((this||w).settings.classNames.tagSelector)){let w=document.createTextNode("");3==y.childNodes[0].nodeType&&"BR"!=y.previousSibling.nodeName&&(w=document.createTextNode("\n")),y.replaceWith(w,...[...y.childNodes].slice(0,-1)),this.placeCaretAfterNode(w)}else if(v.call(this||w,y)&&(3!=y.previousSibling?.nodeType||y.previousSibling.textContent||y.previousSibling.remove(),y.previousSibling&&"BR"==y.previousSibling.nodeName)){y.previousSibling.replaceWith("\n​");let w=y.nextSibling,x="";for(;w;)x+=w.textContent,w=w.nextSibling;x.trim()&&this.placeCaretAfterNode(y.previousSibling)}})),y.removedNodes.forEach((y=>{y&&"BR"==y.nodeName&&v.call(this||w,x)&&(this.removeTags(x),this.fixFirefoxLastTagNoCaret())}))}));var x=(this||w).DOM.input.lastChild;x&&""==x.nodeValue&&x.remove(),x&&"BR"==x.nodeName||(this||w).DOM.input.appendChild(document.createElement("br"))}}};function N(y,x){if(!y){console.warn("Tagify:","input element not found",y);const x=new Proxy(this||w,{get:()=>()=>x});return x}if(y.__tagify)return console.warn("Tagify: ","input element is already Tagified - Same instance is returned.",y),y.__tagify;var D;g(this||w,function(y){var x=document.createTextNode("");function i(w,y,O){O&&y.split(/\s+/g).forEach((y=>x[w+"EventListener"].call(x,y,O)))}return{off(y,x){return i("remove",y,x),this||w},on(y,x){return x&&"function"==typeof x&&i("add",y,x),this||w},trigger(O,D,M){var I;if(M=M||{cloneData:!0},O)if(y.settings.isJQueryPlugin)"remove"==O&&(O="removeTag"),jQuery(y.DOM.originalInput).triggerHandler(O,[D]);else{try{var E="object"==typeof D?D:{value:D};if((E=M.cloneData?g({},E):E).tagify=this||w,D.event&&(E.event=this.cloneEvent(D.event)),D instanceof Object)for(var S in D)D[S]instanceof HTMLElement&&(E[S]=D[S]);I=new CustomEvent(O,{detail:E})}catch(w){console.warn(w)}x.dispatchEvent(I)}}}}(this||w)),(this||w).isFirefox=/firefox|fxios/i.test(navigator.userAgent)&&!/seamonkey/i.test(navigator.userAgent),(this||w).isIE=window.document.documentMode,x=x||{},(this||w).getPersistedData=(D=x.id,w=>{let y,x="/"+w;if(1==localStorage.getItem(O+D+"/v",1))try{y=JSON.parse(localStorage[O+D+x])}catch(w){}return y}),(this||w).setPersistedData=(w=>w?(localStorage.setItem(O+w+"/v",1),(y,x)=>{let D="/"+x,M=JSON.stringify(y);y&&x&&(localStorage.setItem(O+w+D,M),dispatchEvent(new Event("storage")))}):()=>{})(x.id),(this||w).clearPersistedData=(w=>y=>{const x=O+"/"+w+"/";if(y)localStorage.removeItem(x+y);else for(let w in localStorage)w.includes(x)&&localStorage.removeItem(w)})(x.id),this.applySettings(y,x),(this||w).state={inputText:"",editing:!1,composing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},(this||w).value=[],(this||w).listeners={},(this||w).DOM={},this.build(y),b.call(this||w),this.getCSSVars(),this.loadOriginalValues(),(this||w).events.customBinding.call(this||w),(this||w).events.binding.call(this||w),y.autofocus&&(this||w).DOM.input.focus(),y.__tagify=this||w}return N.prototype={_dropdown:x,getSetTagData:T,helpers:{sameStr:s,removeCollectionProp:a,omit:n,isObject:h,parseHTML:r,escapeHTML:d,extend:g,concatWithoutDups:p,getUID:m,isNodeTag:v},customEventsList:["change","add","remove","invalid","input","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim(y){return(this||w).settings.trim&&y&&"string"==typeof y?y.trim():y},parseHTML:r,templates:I,parseTemplate(y,x){return r((y=(this||w).settings.templates[y]||y).apply(this||w,x))},set whitelist(y){const x=y&&Array.isArray(y);(this||w).settings.whitelist=x?y:[],this.setPersistedData(x?y:[],"whitelist")},get whitelist(){return(this||w).settings.whitelist},generateClassSelectors(y){for(let x in y){let O=x;Object.defineProperty(y,O+"Selector",{get(){return"."+(this||w)[O].split(" ")[0]}})}},applySettings(x,O){y.templates=(this||w).templates;var D=g({},y,"mix"==O.mode?{dropdown:{position:"text"}}:{}),I=(this||w).settings=g({},D,O);if(I.disabled=x.hasAttribute("disabled"),I.readonly=I.readonly||x.hasAttribute("readonly"),I.placeholder=d(x.getAttribute("placeholder")||I.placeholder||""),I.required=x.hasAttribute("required"),this.generateClassSelectors(I.classNames),void 0===I.dropdown.includeSelectedTags&&(I.dropdown.includeSelectedTags=I.duplicates),(this||w).isIE&&(I.autoComplete=!1),["whitelist","blacklist"].forEach((w=>{var y=x.getAttribute("data-"+w);y&&(y=y.split(I.delimiters))instanceof Array&&(I[w]=y)})),"autoComplete"in O&&!h(O.autoComplete)&&(I.autoComplete=y.autoComplete,I.autoComplete.enabled=O.autoComplete),"mix"==I.mode&&(I.pattern=I.pattern||/@/,I.autoComplete.rightKey=!0,I.delimiters=O.delimiters||null,I.tagTextProp&&!I.dropdown.searchKeys.includes(I.tagTextProp)&&I.dropdown.searchKeys.push(I.tagTextProp)),x.pattern)try{I.pattern=new RegExp(x.pattern)}catch(x){}if(I.delimiters){I._delimiters=I.delimiters;try{I.delimiters=new RegExp((this||w).settings.delimiters,"g")}catch(x){}}I.disabled&&(I.userInput=!1),(this||w).TEXTS=e(e({},M),I.texts||{}),("select"!=I.mode||O.dropdown?.enabled)&&I.userInput||(I.dropdown.enabled=0),I.dropdown.appendTarget=O.dropdown?.appendTarget||document.body;let E=this.getPersistedData("whitelist");Array.isArray(E)&&((this||w).whitelist=Array.isArray(I.whitelist)?p(I.whitelist,E):E)},getAttributes(w){var y,x=this.getCustomAttributes(w),O="";for(y in x)O+=" "+y+(void 0!==w[y]?`="${x[y]}"`:"");return O},getCustomAttributes(w){if(!h(w))return"";var y,x={};for(y in w)"__"!=y.slice(0,2)&&"class"!=y&&w.hasOwnProperty(y)&&void 0!==w[y]&&(x[y]=d(w[y]));return x},setStateSelection(){var y=window.getSelection(),x={anchorOffset:y.anchorOffset,anchorNode:y.anchorNode,range:y.getRangeAt&&y.rangeCount&&y.getRangeAt(0)};return(this||w).state.selection=x,x},getCSSVars(){var y=getComputedStyle((this||w).DOM.scope,null);var x;(this||w).CSSVars={tagHideTransition:(w=>{let y=w.value;return"s"==w.unit?1e3*y:y})(function(w){if(!w)return{};var y=(w=w.trim().split(" ")[0]).split(/\d+/g).filter((w=>w)).pop().trim();return{value:+w.split(y).filter((w=>w))[0].trim(),unit:y}}((x="tag-hide-transition",y.getPropertyValue("--"+x))))}},build(y){var x=(this||w).DOM;(this||w).settings.mixMode.integrated?(x.originalInput=null,x.scope=y,x.input=y):(x.originalInput=y,x.originalInput_tabIndex=y.tabIndex,x.scope=this.parseTemplate("wrapper",[y,(this||w).settings]),x.input=x.scope.querySelector((this||w).settings.classNames.inputSelector),y.parentNode.insertBefore(x.scope,y),y.tabIndex=-1)},destroy(){(this||w).events.unbindGlobal.call(this||w),(this||w).DOM.scope.parentNode.removeChild((this||w).DOM.scope),(this||w).DOM.originalInput.tabIndex=(this||w).DOM.originalInput_tabIndex,delete(this||w).DOM.originalInput.__tagify,(this||w).dropdown.hide(!0),clearTimeout((this||w).dropdownHide__bindEventsTimeout),clearInterval((this||w).listeners.main.originalInputValueObserverInterval)},loadOriginalValues(y){var x,O=(this||w).settings;if((this||w).state.blockChangeEvent=!0,void 0===y){const x=this.getPersistedData("value");y=x&&!(this||w).DOM.originalInput.value?x:O.mixMode.integrated?(this||w).DOM.input.textContent:(this||w).DOM.originalInput.value}if(this.removeAllTags(),y)if("mix"==O.mode)this.parseMixTags(y),(x=(this||w).DOM.input.lastChild)&&"BR"==x.tagName||(this||w).DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{JSON.parse(y)instanceof Array&&(y=JSON.parse(y))}catch(y){}this.addTags(y,!0).forEach((w=>w&&w.classList.add(O.classNames.tagNoAnimation)))}else this.postUpdate();(this||w).state.lastOriginalValueReported=O.mixMode.integrated?"":(this||w).DOM.originalInput.value,(this||w).state.blockChangeEvent=!1},cloneEvent(w){var y={};for(var x in w)"path"!=x&&(y[x]=w[x]);return y},loading(y){return(this||w).state.isLoading=y,(this||w).DOM.scope.classList[y?"add":"remove"]((this||w).settings.classNames.scopeLoading),this||w},tagLoading(y,x){return y&&y.classList[x?"add":"remove"]((this||w).settings.classNames.tagLoading),this||w},toggleClass(y,x){"string"==typeof y&&(this||w).DOM.scope.classList.toggle(y,x)},toggleScopeValidation(y){var x=!0===y||void 0===y;!(this||w).settings.required&&y&&y===(this||w).TEXTS.empty&&(x=!0),this.toggleClass((this||w).settings.classNames.tagInvalid,!x),(this||w).DOM.scope.title=x?"":y},toggleFocusClass(y){this.toggleClass((this||w).settings.classNames.focus,!!y)},triggerChangeEvent:function(){if(!(this||w).settings.mixMode.integrated){var y=(this||w).DOM.originalInput,x=(this||w).state.lastOriginalValueReported!==y.value,O=new CustomEvent("change",{bubbles:!0});x&&((this||w).state.lastOriginalValueReported=y.value,O.simulated=!0,y._valueTracker&&y._valueTracker.setValue(Math.random()),y.dispatchEvent(O),this.trigger("change",(this||w).state.lastOriginalValueReported),y.value=(this||w).state.lastOriginalValueReported)}},events:E,fixFirefoxLastTagNoCaret(){},setRangeAtStartEnd(y,x){if(x){y="number"==typeof y?y:!!y,x=x.lastChild||x;var O=document.getSelection();if(O.focusNode instanceof Element&&!(this||w).DOM.input.contains(O.focusNode))return!0;try{O.rangeCount>=1&&["Start","End"].forEach((w=>O.getRangeAt(0)["set"+w](x,y||x.length)))}catch(y){}}},placeCaretAfterNode(w){if(w&&w.parentNode){var y=w,x=window.getSelection(),O=x.getRangeAt(0);x.rangeCount&&(O.setStartAfter(y),O.collapse(!0),x.removeAllRanges(),x.addRange(O))}},insertAfterTag(y,x){if(x=x||(this||w).settings.mixMode.insertAfterTag,y&&y.parentNode&&x)return x="string"==typeof x?document.createTextNode(x):x,y.parentNode.insertBefore(x,y.nextSibling),x},editTagChangeDetected(y){var x=y.__originalData;for(var O in x)if(!(this||w).dataProps.includes(O)&&y[O]!=x[O])return!0;return!1},getTagTextNode(y){return y.querySelector((this||w).settings.classNames.tagTextSelector)},setTagTextNode(w,y){this.getTagTextNode(w).innerHTML=d(y)},editTag(y,x){y=y||this.getLastTag(),x=x||{},(this||w).dropdown.hide();var O=(this||w).settings,D=this.getTagTextNode(y),M=this.getNodeIndex(y),I=T(y),E=(this||w).events.callbacks,S=this||w,_=!0;if(D){if(!(I instanceof Object&&"editable"in I)||I.editable)return I=T(y,{__originalData:g({},I),__originalHTML:y.cloneNode(!0)}),T(I.__originalHTML,I.__originalData),D.setAttribute("contenteditable",!0),y.classList.add(O.classNames.tagEditing),D.addEventListener("focus",E.onEditTagFocus.bind(this||w,y)),D.addEventListener("blur",(function(){setTimeout((()=>E.onEditTagBlur.call(S,S.getTagTextNode(y))))})),D.addEventListener("input",E.onEditTagInput.bind(this||w,D)),D.addEventListener("paste",E.onEditTagPaste.bind(this||w,D)),D.addEventListener("keydown",(x=>E.onEditTagkeydown.call(this||w,x,y))),D.addEventListener("compositionstart",E.onCompositionStart.bind(this||w)),D.addEventListener("compositionend",E.onCompositionEnd.bind(this||w)),x.skipValidation||(_=this.editTagToggleValidity(y)),D.originalIsValid=_,this.trigger("edit:start",{tag:y,index:M,data:I,isValid:_}),D.focus(),this.setRangeAtStartEnd(!1,D),this||w}else console.warn("Cannot find element in Tag template: .",O.classNames.tagTextSelector)},editTagToggleValidity(y,x){var O;if(x=x||T(y))return(O=!("__isValid"in x)||!0===x.__isValid)||this.removeTagsFromValue(y),this.update(),y.classList.toggle((this||w).settings.classNames.tagNotAllowed,!O),x.__isValid;console.warn("tag has no data: ",y,x)},onEditTagDone(y,x){x=x||{};var O={tag:y=y||(this||w).state.editing.scope,index:this.getNodeIndex(y),previousData:T(y),data:x};this.trigger("edit:beforeUpdate",O,{cloneData:!1}),(this||w).state.editing=!1,delete x.__originalData,delete x.__originalHTML,y&&x[(this||w).settings.tagTextProp]?(y=this.replaceTag(y,x),this.editTagToggleValidity(y,x),(this||w).settings.a11y.focusableTags?y.focus():this.placeCaretAfterNode(y)):y&&this.removeTags(y),this.trigger("edit:updated",O),(this||w).dropdown.hide(),(this||w).settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(w,y){y&&y.value||(y=w.__tagifyTagData),y.__isValid&&1!=y.__isValid&&g(y,this.getInvalidTagAttrs(y,y.__isValid));var x=this.createTagElem(y);return w.parentNode.replaceChild(x,w),this.updateValueByDOMTags(),x},updateValueByDOMTags(){(this||w).value.length=0,[].forEach.call(this.getTagElms(),(y=>{y.classList.contains((this||w).settings.classNames.tagNotAllowed.split(" ")[0])||(this||w).value.push(T(y))})),this.update()},injectAtCaret(y,x){return!(x=x||(this||w).state.selection?.range)&&y?(this.appendMixTags(y),this||w):(f(y,x),this.setRangeAtStartEnd(!1,y),this.updateValueByDOMTags(),this.update(),this||w)},input:{set(){let y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",x=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var O=(this||w).settings.dropdown.closeOnSelect;(this||w).state.inputText=y,x&&((this||w).DOM.input.innerHTML=d(""+y)),!y&&O&&(this||w).dropdown.hide.bind(this||w),(this||w).input.autocomplete.suggest.call(this||w),(this||w).input.validate.call(this||w)},raw(){return(this||w).DOM.input.textContent},validate(){var y=!(this||w).state.inputText||!0===this.validateTag({value:(this||w).state.inputText});return(this||w).DOM.input.classList.toggle((this||w).settings.classNames.inputInvalid,!y),y},normalize(y){var x=y||(this||w).DOM.input,O=[];x.childNodes.forEach((w=>3==w.nodeType&&O.push(w.nodeValue))),O=O.join("\n");try{O=O.replace(/(?:\r\n|\r|\n)/g,(this||w).settings.delimiters.source.charAt(0))}catch(y){}return O=O.replace(/\s/g," "),this.trim(O)},autocomplete:{suggest(y){if((this||w).settings.autoComplete.enabled){"string"==typeof(y=y||{value:""})&&(y={value:y});var x=(this||w).dropdown.getMappedValue(y);if("number"!=typeof x){var O=x.substr(0,(this||w).state.inputText.length).toLowerCase(),D=x.substring((this||w).state.inputText.length);x&&(this||w).state.inputText&&O==(this||w).state.inputText.toLowerCase()?((this||w).DOM.input.setAttribute("data-suggest",D),(this||w).state.inputSuggestion=y):((this||w).DOM.input.removeAttribute("data-suggest"),delete(this||w).state.inputSuggestion)}}},set(y){var x=(this||w).DOM.input.getAttribute("data-suggest"),O=y||(x?(this||w).state.inputText+x:null);return!!O&&("mix"==(this||w).settings.mode?this.replaceTextWithNode(document.createTextNode((this||w).state.tag.prefix+O)):((this||w).input.set.call(this||w,O),this.setRangeAtStartEnd(!1,(this||w).DOM.input)),(this||w).input.autocomplete.suggest.call(this||w),(this||w).dropdown.hide(),!0)}}},getTagIdx(y){return(this||w).value.findIndex((w=>w.__tagId==(y||{}).__tagId))},getNodeIndex(w){var y=0;if(w)for(;w=w.previousElementSibling;)y++;return y},getTagElms(){for(var y=arguments.length,x=new Array(y),O=0;O<y;O++)x[O]=arguments[O];var D="."+[...(this||w).settings.classNames.tag.split(" "),...x].join(".");return[].slice.call((this||w).DOM.scope.querySelectorAll(D))},getLastTag(){var y=(this||w).DOM.scope.querySelectorAll(`${(this||w).settings.classNames.tagSelector}:not(.${(this||w).settings.classNames.tagHide}):not([readonly])`);return y[y.length-1]},isTagDuplicate(y,x,O){var D=0;if("select"==(this||w).settings.mode)return!1;for(let M of(this||w).value)s(this.trim(""+y),M.value,x)&&O!=M.__tagId&&D++;return D},getTagIndexByValue(y){var x=[];return this.getTagElms().forEach(((O,D)=>{s(this.trim(O.textContent),y,(this||w).settings.dropdown.caseSensitive)&&x.push(D)})),x},getTagElmByValue(w){var y=this.getTagIndexByValue(w)[0];return this.getTagElms()[y]},flashTag(y){y&&(y.classList.add((this||w).settings.classNames.tagFlash),setTimeout((()=>{y.classList.remove((this||w).settings.classNames.tagFlash)}),100))},isTagBlacklisted(y){return y=this.trim(y.toLowerCase()),(this||w).settings.blacklist.filter((w=>(""+w).toLowerCase()==y)).length},isTagWhitelisted(w){return!!this.getWhitelistItem(w)},getWhitelistItem(y,x,O){x=x||"value";var D,M=(this||w).settings;return(O=O||M.whitelist).some((w=>{var O="string"==typeof w?w:w[x]||w.value;if(s(O,y,M.dropdown.caseSensitive,M.trim))return D="string"==typeof w?{value:w}:w,!0})),D||"value"!=x||"value"==M.tagTextProp||(D=this.getWhitelistItem(y,M.tagTextProp,O)),D},validateTag(y){var x=(this||w).settings,O="value"in y?"value":x.tagTextProp,D=this.trim(y[O]+"");return(y[O]+"").trim()?x.pattern&&x.pattern instanceof RegExp&&!x.pattern.test(D)?(this||w).TEXTS.pattern:!x.duplicates&&this.isTagDuplicate(D,x.dropdown.caseSensitive,y.__tagId)?(this||w).TEXTS.duplicate:this.isTagBlacklisted(D)||x.enforceWhitelist&&!this.isTagWhitelisted(D)?(this||w).TEXTS.notAllowed:!x.validate||x.validate(y):(this||w).TEXTS.empty},getInvalidTagAttrs(y,x){return{"aria-invalid":!0,class:`${y.class||""} ${(this||w).settings.classNames.tagNotAllowed}`.trim(),title:x}},hasMaxTags(){return(this||w).value.length>=(this||w).settings.maxTags&&(this||w).TEXTS.exceed},setReadonly(y,x){var O=(this||w).settings;document.activeElement.blur(),O[x||"readonly"]=y,(this||w).DOM.scope[(y?"set":"remove")+"Attribute"](x||"readonly",!0),this.setContentEditable(!y)},setContentEditable(y){(this||w).settings.userInput&&((this||w).DOM.input.contentEditable=y,(this||w).DOM.input.tabIndex=y?0:-1)},setDisabled(w){this.setReadonly(w,"disabled")},normalizeTags(y){var x=(this||w).settings,O=x.whitelist,D=x.delimiters,M=x.mode,I=x.tagTextProp,E=[],S=!!O&&O[0]instanceof Object,_=Array.isArray(y),C=_&&y[0].value,h=w=>(w+"").split(D).filter((w=>w)).map((w=>({[I]:this.trim(w),value:this.trim(w)})));if("number"==typeof y&&(y=y.toString()),"string"==typeof y){if(!y.trim())return[];y=h(y)}else _&&(y=[].concat(...y.map((w=>w.value?w:h(w)))));return S&&!C&&(y.forEach((y=>{var x=E.map((w=>w.value)),O=(this||w).dropdown.filterListItems.call(this||w,y[I],{exact:!0});(this||w).settings.duplicates||(O=O.filter((w=>!x.includes(w.value))));var D=O.length>1?this.getWhitelistItem(y[I],I,O):O[0];D&&D instanceof Object?E.push(D):"mix"!=M&&(null==y.value&&(y.value=y[I]),E.push(y))})),E.length&&(y=E)),y},parseMixTags(y){var x=(this||w).settings,O=x.mixTagsInterpolator,D=x.duplicates,M=x.transformTag,I=x.enforceWhitelist,E=x.maxTags,S=x.tagTextProp,_=[];return y=y.split(O[0]).map(((y,x)=>{var C,A,L,k=y.split(O[1]),V=k[0],P=_.length==E;try{if(V==+V)throw Error;A=JSON.parse(V)}catch(y){A=this.normalizeTags(V)[0]||{value:V}}if(M.call(this||w,A),P||!(k.length>1)||I&&!this.isTagWhitelisted(A.value)||!D&&this.isTagDuplicate(A.value)){if(y)return x?O[0]+y:y}else A[C=A[S]?S:"value"]=this.trim(A[C]),L=this.createTagElem(A),_.push(A),L.classList.add((this||w).settings.classNames.tagNoAnimation),k[0]=L.outerHTML,(this||w).value.push(A);return k.join("")})).join(""),(this||w).DOM.input.innerHTML=y,(this||w).DOM.input.appendChild(document.createTextNode("")),(this||w).DOM.input.normalize(),this.getTagElms().forEach(((w,y)=>T(w,_[y]))),this.update({withoutChangeEvent:!0}),y},replaceTextWithNode(y,x){if((this||w).state.tag||x){x=x||(this||w).state.tag.prefix+(this||w).state.tag.value;var O,D,M=(this||w).state.selection||window.getSelection(),I=M.anchorNode,E=(this||w).state.tag.delimiters?(this||w).state.tag.delimiters.length:0;return I.splitText(M.anchorOffset-E),-1==(O=I.nodeValue.lastIndexOf(x))||(D=I.splitText(O),y&&I.parentNode.replaceChild(y,D)),!0}},selectTag(y,x){var O=(this||w).settings;if(!O.enforceWhitelist||this.isTagWhitelisted(x.value)){(this||w).input.set.call(this||w,x[O.tagTextProp]||x.value,!0),(this||w).state.actions.selectOption&&setTimeout((()=>this.setRangeAtStartEnd(!1,(this||w).DOM.input)));var D=this.getLastTag();return D?this.replaceTag(D,x):this.appendTag(y),(this||w).value[0]=x,this.update(),this.trigger("add",{tag:y,data:x}),[y]}},addEmptyTag(w){var y=g({value:""},w||{}),x=this.createTagElem(y);T(x,y),this.appendTag(x),this.editTag(x,{skipValidation:!0})},addTags(y,x,O){var D=[],M=(this||w).settings,I=[],E=document.createDocumentFragment();if(O=O||M.skipInvalid,!y||0==y.length)return D;switch(y=this.normalizeTags(y),M.mode){case"mix":return this.addMixTags(y);case"select":x=!1,this.removeAllTags()}return(this||w).DOM.input.removeAttribute("style"),y.forEach((y=>{var x,S={},_=Object.assign({},y,{value:y.value+""});if(y=Object.assign({},_),M.transformTag.call(this||w,y),y.__isValid=this.hasMaxTags()||this.validateTag(y),!0!==y.__isValid){if(O)return;if(g(S,this.getInvalidTagAttrs(y,y.__isValid),{__preInvalidData:_}),y.__isValid==(this||w).TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(y.value)),!M.createInvalidTags)return void I.push(y.value)}if("readonly"in y&&(y.readonly?S["aria-readonly"]=!0:delete y.readonly),x=this.createTagElem(y,S),D.push(x),"select"==M.mode)return this.selectTag(x,y);E.appendChild(x),y.__isValid&&!0===y.__isValid?((this||w).value.push(y),this.trigger("add",{tag:x,index:(this||w).value.length-1,data:y})):(this.trigger("invalid",{data:y,index:(this||w).value.length,tag:x,message:y.__isValid}),M.keepInvalidTags||setTimeout((()=>this.removeTags(x,!0)),1e3)),(this||w).dropdown.position()})),this.appendTag(E),this.update(),y.length&&x&&((this||w).input.set.call(this||w,M.createInvalidTags?"":I.join(M._delimiters)),this.setRangeAtStartEnd(!1,(this||w).DOM.input)),M.dropdown.enabled&&(this||w).dropdown.refilter(),D},addMixTags(y){if((y=this.normalizeTags(y))[0].prefix||(this||w).state.tag)return this.prefixedTextToTag(y[0]);var x=document.createDocumentFragment();return y.forEach((w=>{var y=this.createTagElem(w);x.appendChild(y)})),this.appendMixTags(x),x},appendMixTags(y){var x=!!(this||w).state.selection;x?this.injectAtCaret(y):((this||w).DOM.input.focus(),(x=this.setStateSelection()).range.setStart((this||w).DOM.input,x.range.endOffset),x.range.setEnd((this||w).DOM.input,x.range.endOffset),(this||w).DOM.input.appendChild(y),this.updateValueByDOMTags(),this.update())},prefixedTextToTag(y){var x,O=(this||w).settings,D=(this||w).state.tag.delimiters;if(O.transformTag.call(this||w,y),y.prefix=y.prefix||(this||w).state.tag?(this||w).state.tag.prefix:(O.pattern.source||O.pattern)[0],x=this.createTagElem(y),this.replaceTextWithNode(x)||(this||w).DOM.input.appendChild(x),setTimeout((()=>x.classList.add((this||w).settings.classNames.tagNoAnimation)),300),(this||w).value.push(y),this.update(),!D){var M=this.insertAfterTag(x)||x;setTimeout((this||w).placeCaretAfterNode,0,M)}return(this||w).state.tag=null,this.trigger("add",g({},{tag:x},{data:y})),x},appendTag(y){var x=(this||w).DOM,O=x.input;x.scope.insertBefore(y,O)},createTagElem(y,x){y.__tagId=m();var O,D=g({},y,e({value:d(y.value+"")},x));return function(w){for(var y,x=document.createNodeIterator(w,NodeFilter.SHOW_TEXT,null,!1);y=x.nextNode();)y.textContent.trim()||y.parentNode.removeChild(y)}(O=this.parseTemplate("tag",[D,this||w])),T(O,y),O},reCheckInvalidTags(){var y=(this||w).settings;this.getTagElms(y.classNames.tagNotAllowed).forEach(((w,x)=>{var O=T(w),D=this.hasMaxTags(),M=this.validateTag(O),I=!0===M&&!D;if("select"==y.mode&&this.toggleScopeValidation(M),I)return O=O.__preInvalidData?O.__preInvalidData:{value:O.value},this.replaceTag(w,O);w.title=D||M}))},removeTags(y,x,O){var D,M=(this||w).settings;if(y=y&&y instanceof HTMLElement?[y]:y instanceof Array?y:y?[y]:[this.getLastTag()],D=y.reduce(((w,y)=>{y&&"string"==typeof y&&(y=this.getTagElmByValue(y));var x=T(y);return y&&x&&!x.readonly&&w.push({node:y,idx:this.getTagIdx(x),data:T(y,{__removed:!0})}),w}),[]),O="number"==typeof O?O:(this||w).CSSVars.tagHideTransition,"select"==M.mode&&(O=0,(this||w).input.set.call(this||w)),1==D.length&&"select"!=M.mode&&D[0].node.classList.contains(M.classNames.tagNotAllowed)&&(x=!0),D.length)return M.hooks.beforeRemoveTag(D,{tagify:this||w}).then((()=>{function t(y){y.node.parentNode&&(y.node.parentNode.removeChild(y.node),x?M.keepInvalidTags&&this.trigger("remove",{tag:y.node,index:y.idx}):(this.trigger("remove",{tag:y.node,index:y.idx,data:y.data}),(this||w).dropdown.refilter(),(this||w).dropdown.position(),(this||w).DOM.input.normalize(),M.keepInvalidTags&&this.reCheckInvalidTags()))}O&&O>10&&1==D.length?function(y){y.node.style.width=parseFloat(window.getComputedStyle(y.node).width)+"px",document.body.clientTop,y.node.classList.add(M.classNames.tagHide),setTimeout(t.bind(this||w),O,y)}.call(this||w,D[0]):D.forEach(t.bind(this||w)),x||(this.removeTagsFromValue(D.map((w=>w.node))),this.update(),"select"==M.mode&&this.setContentEditable(!0))})).catch((w=>{}))},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach((w=>w.parentNode.removeChild(w)))},removeTagsFromValue(y){(y=Array.isArray(y)?y:[y]).forEach((y=>{var x=T(y),O=this.getTagIdx(x);O>-1&&(this||w).value.splice(O,1)}))},removeAllTags(y){y=y||{},(this||w).value=[],"mix"==(this||w).settings.mode?(this||w).DOM.input.innerHTML="":this.removeTagsFromDOM(),(this||w).dropdown.refilter(),(this||w).dropdown.position(),(this||w).state.dropdown.visible&&setTimeout((()=>{(this||w).DOM.input.focus()})),"select"==(this||w).settings.mode&&((this||w).input.set.call(this||w),this.setContentEditable(!0)),this.update(y)},postUpdate(){var y=(this||w).settings,x=y.classNames,O="mix"==y.mode?y.mixMode.integrated?(this||w).DOM.input.textContent:(this||w).DOM.originalInput.value.trim():(this||w).value.length+(this||w).input.raw.call(this||w).length;this.toggleClass(x.hasMaxTags,(this||w).value.length>=y.maxTags),this.toggleClass(x.hasNoTags,!(this||w).value.length),this.toggleClass(x.empty,!O),"select"==y.mode&&this.toggleScopeValidation((this||w).value?.[0]?.__isValid)},setOriginalInputValue(y){var x=(this||w).DOM.originalInput;(this||w).settings.mixMode.integrated||(x.value=y,x.tagifyValue=x.value,this.setPersistedData(y,"value"))},update(y){clearTimeout((this||w).debouncedUpdateTimeout),(this||w).debouncedUpdateTimeout=setTimeout(function(){var x=this.getInputValue();this.setOriginalInputValue(x),this.postUpdate(),(this||w).settings.onChangeAfterBlur&&(y||{}).withoutChangeEvent||(this||w).state.blockChangeEvent||this.triggerChangeEvent()}.bind(this||w),100)},getInputValue(){var y=this.getCleanValue();return"mix"==(this||w).settings.mode?this.getMixedTagsAsString(y):y.length?(this||w).settings.originalInputValueFormat?(this||w).settings.originalInputValueFormat(y):JSON.stringify(y):""},getCleanValue(y){return a(y||(this||w).value,(this||w).dataProps)},getMixedTagsAsString(){var y="",x=this||w,O=(this||w).settings,D=O.originalInputValueFormat||JSON.stringify,M=O.mixTagsInterpolator;return function i(w){w.childNodes.forEach((w=>{if(1==w.nodeType){const O=T(w);if("BR"==w.tagName&&(y+="\r\n"),O&&v.call(x,w)){if(O.__removed)return;y+=M[0]+D(n(O,x.dataProps))+M[1]}else w.getAttribute("style")||["B","I","U"].includes(w.tagName)?y+=w.textContent:"DIV"!=w.tagName&&"P"!=w.tagName||(y+="\r\n",i(w))}else y+=w.textContent}))}((this||w).DOM.input),y}},N.prototype.removeTag=N.prototype.removeTags,N}));var x=y;export{x as default};

